<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Ulangan Online</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f1f8e9;
      padding: 20px;
    }
    .container {
      max-width: 700px;
      margin: auto;
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }
    .soal {
      margin-bottom: 20px;
      padding: 10px;
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 6px;
    }
    button {
      margin: 10px 5px;
      padding: 10px 20px;
      background: #4caf50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
    }
    button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }
    h3 {
      color: #333;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>Ulangan Sekolah</h2>
    <div id="soal-container"></div>
    <div>
      <button id="prevBtn" onclick="prevPage()">Sebelumnya</button>
      <button id="nextBtn" onclick="nextPage()">Berikutnya</button>
      <button id="submitBtn" onclick="kirimJawaban()" style="display:none;background:#2196F3;">Kirim Jawaban</button>
    </div>
    <h3 id="hasil"></h3>
  </div>

  <script>
    // ==== Data Soal (contoh 50 soal, jawaban benar semua "A") ====
    let soalList = [];
    for (let i = 1; i <= 50; i++) {
      soalList.push({
        tanya: `Soal ke-${i}: Pilih jawaban yang benar?`,
        pilihan: ["A", "B", "C", "D"],
        benar: "A"
      });
    }

    let currentPage = 0;
    const soalPerHalaman = 10;
    let jawabanUser = {};

    function loadSoal() {
      const container = document.getElementById("soal-container");
      container.innerHTML = "";

      let start = currentPage * soalPerHalaman;
      let end = start + soalPerHalaman;

      soalList.slice(start, end).forEach((soal, idx) => {
        let nomor = start + idx + 1;
        let html = `<div class="soal">
          <p><b>${nomor}.</b> ${soal.tanya}</p>`;
        soal.pilihan.forEach(pil => {
          let checked = jawabanUser[nomor] === pil ? "checked" : "";
          html += `<label>
              <input type="radio" name="soal${nomor}" value="${pil}" ${checked} 
              onchange="jawabanUser[${nomor}]='${pil}'"> ${pil}
            </label><br>`;
        });
        html += `</div>`;
        container.innerHTML += html;
      });

      document.getElementById("prevBtn").disabled = currentPage === 0;
      document.getElementById("nextBtn").style.display = currentPage === Math.ceil(soalList.length/soalPerHalaman)-1 ? "none" : "inline-block";
      document.getElementById("submitBtn").style.display = currentPage === Math.ceil(soalList.length/soalPerHalaman)-1 ? "inline-block" : "none";
    }

    function nextPage() {
      let start = currentPage * soalPerHalaman;
      let end = start + soalPerHalaman;
      let adaKosong = false;
      let nomorKosong = null;

      for (let i = start + 1; i <= end; i++) {
        if (!jawabanUser[i]) {
          adaKosong = true;
          nomorKosong = i;
          break;
        }
      }

      if (adaKosong) {
        alert("Masih ada soal yang belum dijawab!");
        const ele = document.querySelector(`input[name='soal${nomorKosong}']`);
        if (ele) ele.scrollIntoView({behavior: "smooth", block: "center"});
        return;
      }

      currentPage++;
      loadSoal();
    }

    function prevPage() {
      currentPage--;
      loadSoal();
    }

    function kirimJawaban() {
      for (let i = 1; i <= soalList.length; i++) {
        if (!jawabanUser[i]) {
          alert(`Soal nomor ${i} belum dijawab!`);
          currentPage = Math.floor((i - 1) / soalPerHalaman);
          loadSoal();
          const ele = document.querySelector(`input[name='soal${i}']`);
          if (ele) setTimeout(() => ele.scrollIntoView({behavior: "smooth", block: "center"}), 300);
          return;
        }
      }

      let benar = 0;
      soalList.forEach((soal, index) => {
        let no = index+1;
        if(jawabanUser[no] === soal.benar){
          benar++;
        }
      });
      let nilai = (benar / soalList.length) * 100;
      document.getElementById("hasil").innerText = `Nilai kamu: ${nilai.toFixed(2)} (Benar ${benar} dari ${soalList.length})`;
      document.getElementById("soal-container").style.display = "none";
      document.getElementById("prevBtn").style.display = "none";
      document.getElementById("nextBtn").style.display = "none";
      document.getElementById("submitBtn").style.display = "none";
    }

    // Cek login
    if (!localStorage.getItem("user")) {
      alert("Kamu harus login dulu!");
      window.location.href = "index.html";
    }

    loadSoal();
  </script>
</body>
</html>
